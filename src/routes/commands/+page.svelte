<script>
  import { v4 as uuidv4 } from 'uuid'
  export let data;
	const { commands } = data;
  // export let inputEdit = ''
  export let inputInsertCommandValue = ''

  export const readCommands = async () => {
      const response = await fetch('/api', {
        method: 'GET',
        headers: {
          'content-type': 'application/json'
        }
      })
    }
  
  export const createCommand = async () => {
      const id = uuidv4()
      const command = inputInsertCommandValue
      const response = await fetch('/api', { 
        method: 'POST',
        body: JSON.stringify({ command: command, id: id}),
        headers: {
          'content-type': 'application/json'
        }
      })
    }
    export const updateCommand = async (id, command) => {
      // const id = uuidv4()
      // const command = inputEdit.valueOf()
      console.log(`command:${command} id: ${id}`)
      const response = await fetch(`/api/${id}`, { // same, static testing
        method: 'PUT',
        body: JSON.stringify({ command: command }),
        headers: {
          'content-type': 'application/json'
        }
      })
    }
  
    export const deleteCommand = async () => {
      const id = uuidv4()
      const command = 'imacommand2' // This is static for testing, needs bound to a variable
      const response = await fetch(`/api/${id}`, { // same, static testing
        method: 'DELETE',
        body: JSON.stringify({ command: command, id: id}),
        headers: {
          'content-type': 'application/json'
        }
      })
    }

  </script>

<h1>Welcome to SvelteKit</h1>
<p>Visit <a href="https://kit.svelte.dev">kit.svelte.dev</a> to read the documentation</p>

<button on:click={readCommands}>Click to get posts</button>
<input type="text" bind:value={inputInsertCommandValue} placeholder="Enter a command">
<button on:click={createCommand}>Add</button>

{#each commands as command}

  <p>{command.command}</p>
  <input type="text" placeholder="" bind:value={command.command}>
  <button on:click={updateCommand(command.id, command.command)}>Edit</button>
  <button>Delete</button>

{/each}